# Список команд

## Сборка документации {#building}

### `web`

```
sobiraka web CONFIG [--output OUTPUT] [--hide-index-html]
```

Команда собирает HTML-документацию, см. [](../21-build-html/1-web.md).

### `pdf`

```
sobiraka pdf CONFIG [VOLUME] [--output OUTPUT]
```

Команда собирает PDF-документацию с помощью WeasyPrint, см. [](../22-build-pdf/1-weasyprint.md).

### `latex`

```
sobiraka [--tmpdir TMPDIR] latex CONFIG [VOLUME] [--output OUTPUT]
```

Команда собирает PDF-документацию с помощью LaTeX, см. [](../22-build-pdf/3-latex.md).

## Проверка проекта {#validation}

### `prover`

```
sobiraka prover CONFIG [--var KEY1=VAL1 --var KEY2=VAL2 ...]
```

Команда выполняет [проверку проекта](../11-overview/05-prover.md), руководствуясь соответствующими настройками.

- Если в настройке [`prover.dictionaries`](1-configuration.md#prover.dictionaries) указан хотя бы один словарь Hunspell (и, опционально, другие словари), выполняется [проверка орфографии](../11-overview/05-prover.md#spell-check).

- Если включена настройка [`prover.phrases_must_begin_with_capitals`](1-configuration.md#prover.phrases_must_begin_with_capitals), выполняется [проверка заглавных букв в начале фраз](../11-overview/05-prover.md#phrases-must-begin-with-capitals).

Все переменные, соответствующие выходным форматам (`HTML`, `PDF` и другие), устанавливаются в `True`. Обычно это позволяет за один раз проверить все абзацы в проектах, использующих [условия Jinja](../12-syntax/2-jinja.md#conditions). Если для вашего проекта такое поведение не подходит, определите необходимые переменные самостоятельно с помощью аргументов `--var`. Если передан хотя бы аргумент `--var`, то остальные переменные, соответствующие выходным форматам, установятся в `False`. Например, вы можете завести две отдельные задачи в CI: одну с `--var HTML=1`, вторую с `--var PDF=1`.

Название команды читается как «Собирака Прувер» или «Собирака, проверь» — оба варианта верны.

### `validate_dictionary`

```
sobiraka validate_dictionary DICTIONARY [--autofix]
```

Команда загружает и проверяет пару файлов для [словаря Hunspell](../11-overview/05-prover.md#hunspell-dictionaries). В качестве аргумента необходимо передавать путь к файлу `*.dic`, но соответствующий ему файл `*.aff` из той же директории тоже будет проверен. Эта команда полностью автономна: она не работает с настройками проекта или другими данными, кроме этих двух файлов.

Некоторые некритические ошибки поддаются автоматическому исправлению. Если команде передан аргумент `--autofix` и при этом все ошибки в файлах некритические, команда автоматически внесёт соответствующие изменения.

В файле `*.dic` могут быть найдены следующие ошибки:

- в файле содержится пустая строка (она может быть автоматически удалена),
- файл ссылается на аффикс, которого нет в файле `*.aff`,
- количество записей в словаре не соответствует его заявленной длине (длина может быть автоматически обновлена).

В файле `*.aff` могут быть найдены следующие ошибки:

- два аффикса имеют одинаковые идентификаторы,
- идентификатор аффикса содержит больше одного символа,
- количество записей для аффикса не соответствует его заявленной длине (длина может быть автоматически обновлена).

## Работа с переводами {#translation}

### `check_translations`

```
sobiraka check_translations CONFIG [--strict]
```

Вспомогательная команда для работы с [мультиязычными проектами](../11-overview/03-multilang.md). Команда сравнивает версии переводов и оригиналов и делит страницы на три категории:

- _Up-to-date_ — версия перевода совпадает с версией оригинала полностью;
- _Modified_ — версия перевода совпадает с версией оригинала с точностью до мажорной составляющей;
- _Outdated_ — версия перевода значительно отличается от версии оригинала.

По умолчанию команда завершается с кодом 1, если хотя бы одна страница в проекте имеет статус “Outdated”. При использовании флага `--strict` команда завершится с кодом 1, если хотя бы одна страница в проекте имеет статус “Outdated” или “Modified”.

Пример вывода:

```
en:
  This is the primary volume
  Pages: 3
ru:
  Up-to-date pages: 1
  Modified pages: 1
    src-ru/aaa.md
  Outdated pages: 1
    src-ru/bbb.md
```

### `changelog`

```
sobiraka changelog CONFIG COMMIT1 [COMMIT2]
```

Вспомогательная команда для работы с [мультиязычными проектами](../11-overview/03-multilang.md). Команда сравнивает два любых коммита в репозитории и анализирует, как изменились версии страниц между ними.

В качестве аргументов `COMMIT1` и `COMMIT2` можно указать хеши коммитов, имена веток, тегов и любые другие выражения, поддерживаемые командой [`git rev-parse`](https://git-scm.com/docs/git-rev-parse). Если второй коммит не указан, то вместо него используется указатель `HEAD`.

Команда корректно обрабатывает случаи, когда корень тома был перемещён между версиями, если при этом не изменился идентификатор тома (см. [Проекты и тома](../11-overview/01-terms.md)). Обратите внимание, что в выводе при этом используются пути к файлам из второго коммита.

Пример вывода:

```
Version upgraded:
  en/version-upgraded.md (1.0 -> 2.4)
Text upgraded:
  en/text-upgraded.md (1.0)
Both upgraded:
  en/both-upgraded.md (1.0 -> 2.4)
Version downgraded:
  en/version-downgraded.md (2.4 -> 1.0)
Both downgraded:
  en/both-downgraded.md (2.4 -> 1.0)
Version appeared:
  en/version-appeared.md (1.0)
Version disappeared:
  en/version-disappeared.md (1.0)
```