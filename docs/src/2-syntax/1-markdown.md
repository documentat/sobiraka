# Поддержка Markdown

Markdown — основной синтаксис исходного текста, поддерживаемый Собиракой. Все файлы с расширением `.md`, а также все файлы с неопознанными расширениями (то есть не [`.rst`](2-rest.md)), интерпретируются как файлы в формате Markdown.

Собирака использует вариацию Markdown, реализованную в конвертере Pandoc. Полную документацию по его особенностям можно найти здесь: [Pandoc’s Markdown](https://pandoc.org/MANUAL.html#pandocs-markdown). В Собираке включены все расширения из конфигурации Pandoc по умолчанию, кроме [`smart`](https://pandoc.org/MANUAL.html#extension-smart), [`raw_html`](https://pandoc.org/MANUAL.html#extension-raw_html) и [`raw_tex`](https://pandoc.org/MANUAL.html#extension-raw_tex). Ниже перечислены некоторые наиболее важные особенности Pandoc Markdown и порядок их обработки.

Также в файлах Markdown, как и в любых текстовых файлах для Собираки, можно использовать [специальные директивы](3-directives.md) и [синтаксис Jinja](4-jinja.md).

## Заголовки {#headers}

Заголовок первого уровня интерпретируется как простой текст без форматирования. Он обрабатывается отдельно от тела страницы — в частности, это означает, что заголовок и тело страницы передаются в разных переменных для [HTML-шаблона](../5-reference/3-template-api.md).

Если после заголовка стоит конструкция `{-}`, Собирака исключает его из [автонумерации](../1-concepts/3-structure.md#autonumeration).

## Подзаголовки {#subheaders}

Заголовок любого уровня, кроме первого, интерпретируется как блочный элемент и может содержать произвольное форматирование.

Если после заголовка стоит конструкция `{-}`, Собирака исключает его из [автонумерации](../1-concepts/3-structure.md#autonumeration).

Каждому заголовку назначается идентификатор (см. [`header_attributes`](https://pandoc.org/MANUAL.html#extension-header_attributes)). Этот идентификатор следует указывать в [ссылках на подзаголовок](../1-concepts/4-links.md#anchor-links), а при сборке [HTML](../3-run/1-html.md) он же может быть виден читателю в строке браузера при переходе к подзаголовку из оглавления.

Если идентификатор не указан явно, то он формируется автоматически на основе текста заголовка. За автоматическое формирование идентификатора отвечает Pandoc Markdown (см. [`auto_identifiers`](https://pandoc.org/MANUAL.html#extension-auto_identifiers)), но это поведение может измениться в будущих версиях Собираки. Для заголовков, ссылки на которые важно сохранять неизменными, рекомендуется указывать идентификаторы эксплицитно.

Обратите внимание, что если на одной странице присутствуют несколько подзаголовков с одинаковыми идентификаторами, это может привести к некорректной работе оглавления и затруднить навигацию для читателя. При обнаружении такой ситуации Собирака выводит предупреждение, но если никакая страница не содержит ссылку на неоднозначный идентификатор, то критической ошибкой это не считается.

::: example
**Пример.** В документе, показанном ниже, первый подзаголовок второго уровня получит автоматический идентификатор `шаг-первый-взять`, а второй — вручную указанный идентификатор `step2`.

```
# Как сделать
## Шаг первый: взять
## Шаг второй: сделать {#step2}
```

:::

## Инфоблоки {#admonitions}

Инфоблоки (примечания, предупреждения, примеры и т.п.) не являются отдельным типом с точки зрения Pandoc Markdown, однако конкретная тема оформления может реализовывать специальное оформление для блоков с определёнными _классами_. Назначать блокам классы можно с помощью расширения [`fenced_divs`](https://pandoc.org/MANUAL.html#extension-fenced_divs). Набор поддерживаемых классов зависит от реализованных функций [`process_div_*()`](../5-reference/4-plugin-api.md#process_div) в теме оформления.

::: example
**Пример.** Тема оформления `book` содержит реализацию функции `process_div_warning()`, поэтому в проектах с этой темой можно писать предупреждения так:

```
::: warning
Мойте руки после еды, если еда была грязная.
:::
```

:::

## Низкоуровневый код {#raw}

Pandoc Markdown содержит расширение [`raw_attribute`](https://pandoc.org/MANUAL.html#extension-raw_attribute), с помощью которого можно писать фрагменты документации не в формате Markdown, а в более низкоуровневом формате. Присутствует возможность включать как блочные, так и инлайновые фрагменты с низкоуровневым кодом.

Фрагменты с конструкцией `{=html}` включаются без изменений в HTML-файлы, но опускаются при сборке PDF.

Фрагменты с конструкцией `{=tex}` включаются без изменений в LaTeX-код для PDF-файлов, но опускаются при сборке HTML.

::: example

**Пример.** В приведённой ниже строке использованы два низкоуровневых фрагмента. При сборке HTML будет использован только первый, а при сборке PDF — только второй. Это позволяет использовать специфичное форматирование для первого формата, заменяя его на более простое жирное выделение для второго.

```md
Нажмите клавишу `<kbd>Esc</kbd>`{=html} `\textbf{Esc}`{=tex}.
```

:::

См. также `HTML` и `PDF` в [переменных Jinja](4-jinja.md).