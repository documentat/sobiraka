{% set DOCKER_PROD_IMAGE = os.environ.get('DOCKER_PROD_IMAGE', 'documentat/sobiraka') %}

# Установка Собираки в Docker

Собираку можно запускать с помощью среды [Docker](https://www.docker.com) на любой операционной системе: Windows, macOS или Linux. Этот способ запуска удобен тем, что позволяет не думать ни о каких зависимостях, кроме самого Docker.

## 1. Установка Docker {#install-docker}

На этом этапе необходимо установить среду запуска контейнеров Docker, если она ещё не установлена на вашем компьютере.

1. Проследуйте инструкциям с официального сайта Docker, чтобы установить один из вариантов среды:

    - [Установка Docker Desktop](https://docs.docker.com/get-docker/) \
      Содержит графический интерфейс для управления контейнерами.

    - [Установка Docker Engine](https://docs.docker.com/engine/install/) \
      Содержит только командный интерфейс, доступен только для Linux.

1. Чтобы проверить установку, откройте окно командной строки и выполните следующую команду:

       docker run --rm alpine echo -e '\nIt works!'

   Эта команда должна скачать небольшой Docker-образ из интернета, а затем вывести сообщение `It works!`. Если вы его видите, значит, Docker работает.

## 2. Загрузка образа Собираки {#docker-pull}

Собирака поставляется в виде _образов_ для среды Docker. В образы входит сама Собирака и её зависимости (в частности, язык программирования Python). На этом этапе необходимо скачать нужный образ, чтобы среда Docker могла использовать его в дальнейшем.

1. Скачайте нужный образ одной из следующих команд:

    - **Стандартный образ** подходит для [сборки HTML](../build-html/web.md) и [сборки PDF через WeasyPrint](../build-pdf/weasyprint.md). Это рекомендуемый образ для большинства пользователей.

          docker pull {{ DOCKER_PROD_IMAGE }}

    - **Образ с поддержкой LaTeX** подходит для [сборки HTML](../build-html/web.md), [сборки PDF через WeasyPrint](../build-pdf/weasyprint.md) и [сборки PDF через LaTeX](../build-pdf/latex.md). Он включает в себя комплект инструментов LaTeX, который используется для оформления файлов PDF, поэтому этот образ занимает чуть больше места и скачивается дольше, чем стандартный образ. Если вы не знаете, что такое LaTeX, скорее всего, этот образ вам не нужен.

          docker pull {{ DOCKER_PROD_IMAGE }}-latex

      Обратите внимание, что далее в этой инструкции приводятся команды для стандартного образа. Если вы решили использовать образ с поддержкой LaTeX, не забывайте добавлять `-latex` к названию образа в командах.

1. Чтобы проверить установку, выполните следующую команду:

        docker run --rm {{ DOCKER_PROD_IMAGE }} sobiraka --help

   Появится краткий перечень доступных команд, начинающийся со слов `usage: sobiraka`.

## 3. Сборка документации {#build-docs}

Осталось сделать самое главное: начать писать документацию и собирать её с помощью Собираки.

::: warning
**Примечание для пользователей Windows**

Примеры команд на этом этапе приведены для Linux и macOS. Если вы используете Windows, вам понадобится слегка отредактировать их перед запуском.

Различие состоит в том, как именно команда передаёт в Docker информацию о текущей директории (переменная `$PWD` в примерах):

- для Командной строки замените `$PWD` на `%cd%`,
- для PowerShell замените `$PWD` на `${PWD}`,
- для Git Bash замените `$PWD` на `/$(pwd)`.

Кроме того, если вы используете Windows, удаляйте во всех командах параметр `-it`.
:::

1. Создайте новую папку для проекта документации, а в ней — подпапку `src`.

1. В папке проекта создайте файл [`sobiraka.yaml`](../reference/configuration.md) следующего содержания:

   ```yaml
   title: Пример документации
   paths:
     root: src
   ```

1. В подпапке `src` создайте файл [`_index.md`](/organizing/files.md#directories-and-index-files) следующего содержания:

       # Пример документации
       Эта документация собирается Собиракой.

1. Откройте окно командной строки и перейдите в папку проекта. Например:

       cd /home/user/myclient/docs

1. Чтобы собрать документацию в формате HTML, выполните следующую команду:

       docker run --rm -it -v $PWD:/W {{ DOCKER_PROD_IMAGE }} sobiraka web

   Когда сборка завершится, готовые файлы появятся в поддиректории `build/web`. Чтобы посмотреть документацию, в любом браузере откройте файл `build/web/index.html`.

1. Чтобы собрать документацию в формате PDF, выполните следующую команду:

       docker run --rm -it -v $PWD:/W {{ DOCKER_PROD_IMAGE }} sobiraka pdf

   Когда сборка завершится, готовый файл появится в поддиректории `build/pdf`.