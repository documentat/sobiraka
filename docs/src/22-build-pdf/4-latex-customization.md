# Кастомизация LaTeX

На внешний вид документации, собираемой через LaTeX, могут влиять сразу несколько разных настроек и файлов. Часть из них определяется напрямую в конфиге вашего проекта, а часть загружается из директории темы оформления, указанной в настройке [`latex.theme`](../99-reference/1-configuration.md#volume.latex.theme). Все настройки и файлы опциональны.

::: note
**Шпаргалка.** Код LaTeX формируется в следующем порядке:

1. [объявления путей](#paths),
1. [объявления переменных](#variables),
1. [стили (из темы)](#style),
1. [дополнительные объявления для тома](#header),
1. открытие блока с содержимым,
1. [обложка (из темы)](#cover),
1. [оглавление (из темы)](#toc),
1. [обработанное плагином](#plugin) содержимое всех страниц,
1. закрытие блока с содержимым.

:::

## Пути {#paths}

Некоторые конструкции в LaTeX требуют абсолютных путей к дополнительным файлам. Например, если для [оформления обложки](#cover) вы используете команду LaTeX `\includesvg`, вам могут потребоваться абсолютные пути к логотипам и другим элементам фирменного стиля.

С помощью настройки [`latex.paths`](../99-reference/1-configuration.md#volume.latex.paths) вы можете перечислить пути к необходимым вам директориям в проекте. Собирака передаст пути в LaTeX в виде команд, предварительно преобразовав каждый путь в абсолютный.

::: example

**Пример.** Допустим, что проект находится в директории `/home/user/mydocs`. Следующая конфигурация определит команду `\IMAGES`, возвращающую путь `/home/user/mydocs/resources/images/`. Её можно будет использовать в LaTeX как любую другую команду, например: `\includesvg{\IMAGES/logo.svg}`.

```yaml
pdf-latex:
  paths:
    IMAGES: resources/images
```

:::

## Переменные {#variables}

Собирака объявляет в LaTeX следующие команды-переменные:

- `\TITLE` — заголовок тома (см. настройку [`title`](../99-reference/1-configuration.md#volume.title));
- `\LANG` — идентификатор языка тома (см. [](../11-overview/03-multilang.md));
- все переменные, заданные с помощью настройки [`variables`](../99-reference/1-configuration.md#volume.variables).

::: example

**Пример.** Следующая конфигурация определит команды `\PRODUCT` и `\VERSION`. Их можно будет использовать в LaTeX как любые другие команды, например: `Документация по \PRODUCT \VERSION`.

```yaml
variables:
  PRODUCT: Sobiraka
  VERSION: 0.0.1
```

:::

## Файл стилей {#style}

Файл `style.sty` определяется темой оформления и подключается до начала документа (до `\begin{document}`). С его помощью можно подключить необходимые пакеты LaTeX, выбрать шрифты для документа, установить глобальные параметры и определить собственные команды LaTeX.

Как правило, это самый большой небинарный файл в теме оформления LaTeX.

## Файл дополнительных объявлений {#header}

С помощью настройки [`latex.header`](../99-reference/1-configuration.md#volume.latex.header) можно указать файл с дополнительными командами LaTeX, необходимыми для конкретного тома. Эти команды вставляются после содержимого файла стилей, но тоже до начала документа (до `\begin{document}`).

## Обложка {#cover}

Файл `cover.tex` обычно используется для создания обложки документа.

::: note
В проектах из нескольких томов используйте переменную `\TITLE`, чтобы подставить на обложку каждого PDF-файла нужное название.
:::

## Оглавление {#toc}

Файл `toc.tex` обычно используется для генерации оглавления средствами LaTeX.

## Плагин для обработки страниц {#plugin}

В файле `theme.py` может быть определён _плагин_ — код на Python для дополнительной обработки содержимого перед рендерингом.

Класс плагина должен наследоваться от класса `sobiraka.processing.plugin.LatexTheme`. Плагин имеет почти неограниченные возможности в рамках обработки отдельной страницы, см. [](../99-reference/4-plugin-api.md).

::: note
Собирака содержит вспомогательные классы для работы с LaTeX-пакетами `minted` и `tabularray`. Чтобы использовать возможности, предоставляемые этими классами, добавьте их в качестве базовых наравне с `LatexTheme`. Подробнее читайте в исходном коде Собираки.
:::