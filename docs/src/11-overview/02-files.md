# Работа с файлами

::: note

Все примеры на этой странице приведены для проекта, в котором все файлы написаны на Markdown и имеют расширение `.md`. Все те же принципы работают и для проектов на ReST с расширением `.rst`.

:::

## Иерархия {#hierarchy}

Структура документации определяется расположением и именами файлов. Каждая папка автоматически становится отдельным разделом — или подразделом, или подподразделом, называйте как хотите. Количество уровней вложенности не ограничено Собиракой, но помните, что слишком глубокая вложенность может плохо поддерживаться той темой оформления, которую вы используете. (А также плохо восприниматься вашими читателями!)

Для каждого раздела Собирака всегда создаёт главную страницу. При сборке PDF её содержимое отображается в начале раздела, а при сборке HTML страница становится отдельным файлом `index.html`. Многие веб-серверы поддерживают `index.html` как имя файла по умолчанию, и это обычно позволяет видеть главную страницу раздела и по ссылке вида `/example/index.html`, и по более красивой ссылке вида `/example/`. С точки зрения навигации главная страница раздела является родительской по отношению к остальным, то есть другие страницы раздела как бы вложены в неё.

В качестве содержимого для главной страницы раздела используется текст из файла `index.md` (это имя можно изменить через настройку [`paths.naming_scheme`](../99-reference/1-configuration.md#paths.naming_scheme)), а если такого файла в разделе нет — то в `index.html` автоматически сгенерируется [оглавление раздела](#toc).

::: example

**Пример.** Ниже показано, как исходные файлы превращаются в HTML-страницы конечного сайта. Страницы, открывающиеся по адресам `/introduction.html` и `/setup/`, будут отображаться в меню как страницы одного и того же уровня. При этом в меню будут отображены три дочерние страницы по отношению к `/setup/`.

```
/index.md          →  /
/introduction.md   →  /introduction.html
/setup/index.md    →  /setup/
/setup/linux.md    →  /setup/linux.html
/setup/macos.md    →  /setup/macos.html
/setup/windows.md  →  /setup/windows.html
```

:::

## Порядок страниц {#ordering}

В примере проекта, приведённом выше, Собирака на каждом уровне вложенности сортирует страницы по именам файлов. Такой подход бывает удобен для справочников API, однако в большинстве случаев техписателю нужен больший контроль над порядком страниц в документации. Вы можете влиять на порядок страниц через числовые префиксы.

Чтобы назначить странице числовой префикс, просто добавьте к имени файла число, отделённое дефисом. Например: `windows.md` → `1-windows.md`. Этот префикс не попадёт в имя конечного файла (оно будет по-прежнему `windows.html`), но даст Собираке понять, что страница должна идти раньше, чем соседняя страница с префиксом `2`.

Сортировка страниц внутри каждой папки выполняется по следующему алгоритму:

1. Первой идёт страница с именем `index.md` или числовым префиксом `0` (или всем сразу: `0-index.md`). Если такой страницы нет, используется автоматически сгенерированная страница с оглавлением.
2. Затем следуют все страницы с другими числовыми префиксами в порядке возрастания.
3. Затем следуют все страницы без числовых префиксов в алфавитном порядке.

На то, как именно Собирака делит имя файла на числовой префикс и основную часть, можно повлиять через настройку [`paths.naming_scheme`](../99-reference/1-configuration.md#paths.naming_scheme). Например, можно использовать вместо дефиса точку или игнорировать какой-нибудь суффикс. Для изменения настройки потребуется знать регулярные выражения.

::: example

**Пример.** Ниже показана изменённая структура проекта из примера выше. Собранная документация будет отличаться от предыдущей только тем, в каком порядке следуют страницы внутри раздела `/setup/`.

```
/0-index.md            →  /
/1-introduction.md     →  /introduction.html
/2-setup/0-index.md    →  /setup/
/2-setup/1-windows.md  →  /setup/windows.html
/2-setup/2-macos.md    →  /setup/macos.html
/2-setup/3-linux.md    →  /setup/linux.html
```

:::

## Автонумерация {#autonumeration}

Если включить настройку [`content.numeration`](../99-reference/1-configuration.md#content.numeration), Собирака будет вычислять номера для заголовков и подзаголовков в документации. Подзаголовки внутри каждой страницы включаются в общую нумерацию наравне с дочерними страницами.

Чтобы исключить произвольный заголовок и все его подзаголовки из нумерации, необходимо добавить к нему модификатор `{-}` (работает только в Markdown). Это может быть полезным для таких разделов как «Введение», «Приложение» и т.п.

::: example

**Пример.** Ниже показаны заголовки с автонумерацией, которые могут получиться, если предположить, что к заголовку в файле `1-introduction.md` добавлен модификатор `{-}`. Обратите внимание, что на итоговую нумерацию не влияют числовые префиксы из имён файлов: например, «Установка в Windows» получила номер 1.1, а не 2.1.

```
/0-index.md            →  Главная страница
/1-introduction.md     →  Введение
/2-setup/0-index.md    →  1. Установка
/2-setup/1-windows.md  →  1.1. Установка в Windows
/2-setup/2-macos.md    →  1.2. Установка в macOS
/2-setup/3-linux.md    →  1.3. Установка в Linux
```

:::

## Оглавления {#toc}

Собирака генерирует оглавление документации на одном из последних шагов сборки, когда уже известны и заголовки всех страниц, и даже подзаголовки внутри страниц. Это позволяет, если необходимо, создавать «сквозные оглавления» — оглавления, в которые включены пункты, ведущие на подзаголовки каждой страницы.

Настройка [`web.combined_toc`](../99-reference/1-configuration.md#web.combined_toc) определяет, будет ли Собирака генерировать сквозное оглавление при сборке HTML. Разработчик HTML-темы может вызвать функцию `toc()`, чтобы получить глобальное (либо сквозное) оглавление, а также функцию `local_toc()`, чтобы получить оглавление по подзаголовкам текущей страницы. В значениях, которые возвращают эти функции, доступна в том числе информация о нумерации, если она включена.

Кроме этого, Собирака позволяет вставить на любую страницу оглавление по дочерним страницам: для этого добавьте в исходный текст страницы директиву [`@toc`](../12-syntax/3-directives.md#toc). В зависимости от переданных директиве параметров, Собирака может сделать такое оглавление тоже сквозным.

В качестве текста ссылки на каждую страницу используется её заголовок первого уровня или значение [`title`](../99-reference/2-metadata.md#title) из её метаданных.

::: example

**Пример.** Ниже показан пример сквозного оглавления. В него включены ссылки как на страницы, так и на их конкретные подразделы.

```
/0-index.md                     →  Главная страница
/1-introduction.md              →    Введение
/2-setup/0-index.md             →    Установка
/2-setup/1-windows.md           →      Установка в Windows
/2-setup/1-windows.md#download  →        Скачайте установщик
/2-setup/1-windows.md#run       →        Запустите установщик
/2-setup/2-macos.md             →      Установка в macOS
/2-setup/2-macos.md#download    →        Скачайте установщик
/2-setup/2-macos.md#run         →        Запустите установщик
/2-setup/3-linux.md             →      Установка в Linux
/2-setup/3-linux.md#download    →        Скачайте установщик
/2-setup/3-linux.md#run         →        Запустите установщик
```

:::
